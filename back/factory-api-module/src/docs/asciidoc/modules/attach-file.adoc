[[Attach-File-API]]
== ğŸ“‚ íŒŒì¼ ê´€ë¦¬ ëª¨ë“ˆ (AttachFile)

ì´ ëª¨ë“ˆì€ ì‹œìŠ¤í…œ ë‚´ì˜ ëª¨ë“  íŒŒì¼ ì—…ë¡œë“œ, ì¡°íšŒ, ë‹¤ìš´ë¡œë“œ ë° ì •ë¦¬ë¥¼ ë‹´ë‹¹í•©ë‹ˆë‹¤. ëª¨ë“  ì„±ê³µ ì‘ë‹µì€ ê³µí†µ ë˜í¼(code, data)ì— ê°ì‹¸ì ¸ ë°˜í™˜ë©ë‹ˆë‹¤.

=== 1. ì‹ ê·œ íŒŒì¼ ê·¸ë£¹ ì—…ë¡œë“œ
ì—¬ëŸ¬ ê°œì˜ íŒŒì¼ì„ ì—…ë¡œë“œí•˜ì—¬ ìƒˆë¡œìš´ íŒŒì¼ ê·¸ë£¹ì„ ìƒì„±í•©ë‹ˆë‹¤. ë°˜í™˜ëœ ULIDëŠ” ë©”ì¸ ì—”í‹°í‹°(ê²Œì‹œê¸€ ë“±) ì €ì¥ ì‹œ ì‚¬ìš©ë©ë‹ˆë‹¤.

==== Request
include::{snippets}/upload-new-group/http-request.adoc[]

// ë©€í‹°íŒŒíŠ¸ íŒŒë¼ë¯¸í„° ìƒì„¸
==== Request Parts
include::{snippets}/upload-new-group/request-parts.adoc[]

==== Response
include::{snippets}/upload-new-group/http-response.adoc[]

// ì‘ë‹µ í•„ë“œ ìƒì„¸
==== Response Fields
include::{snippets}/upload-new-group/response-fields.adoc[]

---

=== 2. íŒŒì¼ ëª©ë¡ ì¡°íšŒ
íŒŒì¼ ê·¸ë£¹ ID(ULID)ë¥¼ ì‚¬ìš©í•˜ì—¬ í•´ë‹¹ ê·¸ë£¹ì— ì†í•œ ëª¨ë“  íŒŒì¼ì˜ ë©”íƒ€ë°ì´í„° ë¦¬ìŠ¤íŠ¸ë¥¼ ì¡°íšŒí•©ë‹ˆë‹¤.

==== Request
include::{snippets}/search-files/http-request.adoc[]

// ê²½ë¡œ ë³€ìˆ˜ ìƒì„¸
==== Path Parameters
include::{snippets}/search-files/path-parameters.adoc[]

==== Response
include::{snippets}/search-files/http-response.adoc[]

==== Response Fields
include::{snippets}/search-files/response-fields.adoc[]

---

=== 3. ë‹¨ì¼ íŒŒì¼ ë‹¤ìš´ë¡œë“œ
ê°œë³„ íŒŒì¼ ì‹ë³„ìë¥¼ í†µí•´ ë¬¼ë¦¬ íŒŒì¼ì„ ë‹¤ìš´ë¡œë“œí•©ë‹ˆë‹¤. ì´ APIëŠ” ê³µí†µ ì‘ë‹µ ë˜í¼ë¥¼ ì‚¬ìš©í•˜ì§€ ì•Šê³  ìˆœìˆ˜ ë°”ì´ë„ˆë¦¬ ë°ì´í„°ë¥¼ ë°˜í™˜í•©ë‹ˆë‹¤.

==== Request
include::{snippets}/download-file/http-request.adoc[]

==== Path Parameters
include::{snippets}/download-file/path-parameters.adoc[]

==== Response
// ë‹¤ìš´ë¡œë“œëŠ” ë°”ì´ë„ˆë¦¬ì´ë¯€ë¡œ ì‘ë‹µ ì˜ˆì‹œë§Œ ë³´ì—¬ì¤Œ
include::{snippets}/download-file/http-response.adoc[]

---

=== 4. íŒŒì¼ ì˜êµ¬ ì‚­ì œ (Purge)
ë°ì´í„°ë² ì´ìŠ¤ ë©”íƒ€ë°ì´í„°ì™€ ë¬¼ë¦¬ íŒŒì¼ì„ ì¦‰ì‹œ ì™„ì „íˆ ì‚­ì œí•©ë‹ˆë‹¤. ì´ ì‘ì—…ì€ ë³µêµ¬í•  ìˆ˜ ì—†ìŠµë‹ˆë‹¤.

==== Request
include::{snippets}/purge-file/http-request.adoc[]

==== Path Parameters
include::{snippets}/purge-file/path-parameters.adoc[]

==== Response
include::{snippets}/purge-file/http-response.adoc[]

---

=== 5. ê³µí†µ ì—ëŸ¬ ì‘ë‹µ
ì˜ëª»ëœ ID í˜•ì‹ì´ë‚˜ ê¶Œí•œ ë¬¸ì œ ë°œìƒ ì‹œ ë°˜í™˜ë˜ëŠ” í‘œì¤€ ì—ëŸ¬ í˜•ì‹ì…ë‹ˆë‹¤.

==== Response
include::{snippets}/error-handling/http-response.adoc[]

==== Response Fields
include::{snippets}/error-handling/response-fields.adoc[]


---

=== 6. ê¸°ì¡´ ê·¸ë£¹ì— íŒŒì¼ ì¶”ê°€
ì´ë¯¸ ìƒì„±ëœ íŒŒì¼ ê·¸ë£¹(ULID)ì— ìƒˆë¡œìš´ íŒŒì¼ì„ ì¶”ê°€ë¡œ ì—…ë¡œë“œí•©ë‹ˆë‹¤.

==== Request
include::{snippets}/upload-to-existing-group/http-request.adoc[]

==== Path Parameters
include::{snippets}/upload-to-existing-group/path-parameters.adoc[]

==== Request Parts
include::{snippets}/upload-to-existing-group/request-parts.adoc[]

==== Response
include::{snippets}/upload-to-existing-group/http-response.adoc[]

---

=== 7. ì—¬ëŸ¬ íŒŒì¼ ZIP ë‹¤ìš´ë¡œë“œ
ê°œë³„ íŒŒì¼ ID ëª©ë¡ì„ ë°›ì•„ í•˜ë‚˜ì˜ ZIP ì•„ì¹´ì´ë¸Œë¡œ ë‹¤ìš´ë¡œë“œí•©ë‹ˆë‹¤.

==== Request
include::{snippets}/download-zip/http-request.adoc[]

==== Query Parameters
include::{snippets}/download-zip/query-parameters.adoc[]

==== Response
include::{snippets}/download-zip/http-response.adoc[]

---

=== ğŸ“Š í˜‘ì—… ì‹œí€€ìŠ¤ ë‹¤ì´ì–´ê·¸ë¨

ì™¸ë¶€ ëª¨ë“ˆ(ê²Œì‹œíŒ, ìƒí’ˆ ë“±)ì´ ì²¨ë¶€íŒŒì¼ ëª¨ë“ˆì„ ì‚¬ìš©í•˜ëŠ” í‘œì¤€ íë¦„ì…ë‹ˆë‹¤.

image::images/attach-file-collaboration-sequence-diagram.png[]

[plantuml]
----
@startuml
autonumber
skinparam monochrome true
actor "User (Client)" as User
participant "External Module" as External
participant "AttachFile Module" as Attach
database "Storage / DB" as DB

User -> Attach : 1. íŒŒì¼ ì—…ë¡œë“œ (POST)
Attach -> DB : ì„ì‹œ ì €ì¥ (is_linked=false)
Attach --> User : AttachFileId ë°˜í™˜

User -> External : 2. ë©”ì¸ ì—”í‹°í‹° ì €ì¥ (ID í¬í•¨)
External -> DB : ë°ì´í„° ì €ì¥
External -[#blue]> Attach : 3. AttachFileConfirmCommand (Event)
Attach -> DB : ì—°ê²° í™•ì • (is_linked=true)

External --> User : ì™„ë£Œ ì‘ë‹µ
@enduml
----
